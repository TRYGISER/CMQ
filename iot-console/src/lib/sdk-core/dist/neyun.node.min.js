!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NEYUN=t():e.NEYUN=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);Object.defineProperty(t,"Service",{enumerable:!0,get:function(){return r(o).default}});var i=n(2);Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return r(i).default}})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,o){r(this,e),this.serverName=t,this.request=n,this.$env={},o&&(this.apis=o,this.$config(Object.keys(o),o))}return o(e,[{key:"$requestWrap",value:function(e,t){var n=void 0;if(t.check&&!1===t.check(e))throw new Error("check data error",e);return t.mock&&(n=t.mock(e)),n&&n.then?n:this.request(e)}},{key:"$config",value:function(e,t){var n=this;return t=t||this.apis,(Array.isArray(e)?e:Object.keys(e)).forEach(function(r){var o=n;(Array.isArray(e)?e.includes(r):!0===e[r])?n[r]=function e(n){var i=t[r];if(!i)throw new Error("no such api, check api config");return o.$requestWrap(i.init(this)(n),e)}:n[r]=e[r]}),this}},{key:"$setENV",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.$env,e),this}},{key:"$set",value:function(e,t){return this.$env[e]=t,this}},{key:"$get",value:function(e){return this.$env[e]}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n={};return Object.keys(e).forEach(function(r){n[r]=new f(e[r],t)}),e={},n}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=o;var u=n(3),a=(n(4),n(5)),c=n(6),s=["PATCH","POST","PUT"],f=function(){function e(t,n){r(this,e);var o=t.url;this.sign=t.sign,this.url=o.path,this.serverName=n,this.query=o.query,this.method=o.method.toUpperCase(),this.headers=t.headers,this.config=t.config,this.body=t.body}return i(e,[{key:"init",value:function(e){var t=this;return function(n){var r=e.$env,o=t.method;n=n||{};var i=t.url,f=n.path;f&&(i=(0,u.resolvePath)(i,f));var h=n.query;h||Object.keys(n).forEach(function(e){var t=n[e];["headers","config","body","path"].includes(e)||(h[e]=t)});var d=Object.assign({},t.query,h),l=Object.assign({},t.headers,n.headers),p=Object.assign({},t.config,n.config),y="";if(s.includes(o)&&(y=Array.isArray(n.body)?n.body:Object.assign({},t.body,n.body)||y),t.sign){if(!l.host&&!r.host)throw new Error("host is required if you want to sign");l.host=l.host||a.parse(r.host).host,c.sign(r.region,r.AK,r.SK,o,t.url,t.serverName,d,l,y)}return i=(0,u.concatURL)(i,d),{url:i,body:y,headers:l,method:o,config:p,query:d,path:f}}}}]),e}()},function(e,t,n){"use strict";function r(e){return"string"==typeof e}function o(e){return-1!==Object.prototype.toString.call(e).indexOf("Object")}function i(e,t){var n="";return n=r(t)?t:o(t)?a(t):(t||"").toString(),n&&(e+=(-1===e.indexOf("?")?"?":"&")+n),e}function u(e,t){return e&&o(t)?e.replace(/\{(.*?)\}/g,function(e,n){return t[n]||e}):e}Object.defineProperty(t,"__esModule",{value:!0}),t.isString=r,t.isObject=o,t.concatURL=i,t.resolvePath=u;var a=function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}},function(e,t){e.exports=require("request")},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";function r(e,t,n,r,o,i,a,c,f){var g=[];g.push(r),g.push(o),d(c),g.push(s(a));var b=(new Date).toISOString().split(".")[0]+"Z",m=b.split("T")[0].replace(/-/g,""),k=m+"/"+e+"/"+i+"/163_request",w=h(b,!0);Object.assign(c,w);var S=y(c);g.push(l(c)),g.push(S),g.push(v(JSON.stringify(f)));var _=[u.signatureMethod,b,k,p(g.join("\n")).toLowerCase()].join("\n"),A=j(n,e,m,i);c.Authorization=u.signatureMethod+" Credential="+t+"/"+k+", SignedHeaders="+S+", Signature="+O(_,A)}Object.defineProperty(t,"__esModule",{value:!0}),t.sign=r;var o=n(7),i=function(e){return e&&e.__esModule?e:{default:e}}(o),u={signatureMethod:"HMAC-SHA256",hash:"sha256"},a=new Set(["X-163-SignedHeaders","X-163-Signature","Authorization"]),c=new Set([].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a),["X-163-Date","X-163-Credential","X-163-SignatureVersion","X-163-SignatureMethod","X-163-SignatureNonce","X-163-DryRun"])),s=function(e){return Object.keys(e).sort().map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},f=function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t},h=function(e){return{"X-163-Date":e,"X-163-SignatureVersion":"2.0","X-163-SignatureNonce":f().replace(/-/,"")}},d=function(e){Object.keys(e).forEach(function(t){c.has(t)&&delete e[t]})},l=function(e){return Object.keys(e).sort().map(function(t){return t.toLowerCase()+":"+(e[t]||"")}).join("\n")+"\n"},p=function(e){var t=i.default.createHash(u.hash);return t.update(e),t.digest("hex")},y=function(e){var t=[];return Object.keys(e).forEach(function(e){a.has(e)||t.push(e.toLowerCase())}),t.sort().join(";")},v=function(e){return p(e).toLowerCase()},g=function(e,t){return i.default.createHmac("sha256",e).update(t,"utf8").digest()},b=function(e,t){return i.default.createHmac("sha256",e).update(t,"utf8").digest("hex")},j=function(e,t,n,r){return g(g(g(g(Buffer.from("163"+e),n),t),r),"163_request")},O=function(e,t){return b(t,e)}},function(e,t){e.exports=require("crypto")}])});